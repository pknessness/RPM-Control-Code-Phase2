/*
  CAN Send Example

  This will setup the CAN controller(MCP2515) to send CAN frames.
  Transmitted frames will be printed to the Serial port.
  Transmits a CAN standard frame every 2 seconds.

  MIT License
  https://github.com/codeljo/AA_MCP2515
*/

// 141 is outer 142 is inner
// motors[0] is 141 motors[1] is 142
#define MAX_VELO_RPM 15
#define ACCEL_RAD_S_S 0.2
#define DT_MS 300
#define ANGLE_OF_ATTACK 15
#define SEED 2132138

#define EN_CAN 1

#include "AA_MCP2515.h"

#define TIMING_CYCLE 100
#define TIMING_TOLERANCE 10

#define SERIAL_TIMING 0
#define COMMAND_TIMING 20
#define QUERY_TIMING 40
#define PRINT_TIMING 80

#define DT_CYCLES DT_MS/TIMING_CYCLE

#define CYCLOIDAL_TIME_PER_ROTATION 600000L

#define NUM_POINTS 1500
#define CAND_POINTS 50

#define ENCODER_MAX_TICKS 16384

enum MotorProfile{
  MOTOR_BOTH_OFF, 
  MOTOR_SIMPLIFIED_RANDOM, 
  MOTOR_2D, 
  MOTOR_3D,
  MOTOR_IRRATIONAL,
  MOTOR_CYCLOIDAL,
  MOTOR_BRW
}; 

MotorProfile currentProfile = MOTOR_3D;

void setMotorProfile(MotorProfile profile);


struct Motor {
  int16_t angle;
  int16_t velocity;
  int16_t current;
  uint8_t temp;

  uint16_t encoder;
  uint16_t encoderRaw;
  int16_t encoderOffset;
};

// void printMotor(Motor m, char c = '?');
void setVelocity(uint16_t canID, int32_t velocity_dps_hundreth);
void setAngle(uint16_t canID, int16_t velocity_dps, int16_t angle_deg_hundreth);

// TODO: modify CAN_BITRATE, CAN_PIN_CS(Chip Select) pin, and CAN_PIN_INT(Interrupt) pin as required.
const CANBitrate::Config CAN_BITRATE = CANBitrate::Config_8MHz_500kbps;
const uint8_t CAN_PIN_CS = 10;
const int8_t CAN_PIN_INT = 2;

CANConfig config(CAN_BITRATE, CAN_PIN_CS, CAN_PIN_INT);
CANController CAN(config);

Motor motorA;
Motor motorB;

Motor motors[2] = {motorA, motorB};

double heading = 0;

double velo_angle = 0;

// String inst;

int commandLoop = 0;
int printLoopCount = 0;

const char endCharA = 'A';
const char endCharB = 'B';
const char purge = '_';

float valueA = 0;
float valueB = 0;

int pointCount = 0;

char mode = 'm';

bool serialRead = 0;
bool commandSent = 0;
bool querySent = 0;
bool imuRecv = 0;
bool printSent = 0;


float veloBRW_lastChange = 0;
float veloBRW_changeDT = 200; // milliseconds
float veloBRW_maxVelocity = MAX_VELO_RPM;
float veloBRW_coneAngle = 60 * PI / 180;
float veloBRW_coneLength = 0.55;
float veloBRW_coneMinLength = 0.01;
float veloBRW_prevPos[2] = {0,0}; // {inner, outer}
float veloBRW_pointsInRange[CAND_POINTS][3] = {0};
float veloBRW_coneLengthSquared = veloBRW_coneLength*veloBRW_coneLength;
float veloBRW_coneMinLengthSquared = veloBRW_coneMinLength*veloBRW_coneMinLength;
long previous_time = 0;
float pos_sph[2] = {0,0}; // {inner, outer}
float curr_x = 0, curr_y = 0, curr_z = 0;
float prev_x = 0, prev_y = 0, prev_z = 0;
float des_x  = 0, des_y  = 0, des_z  = 0;
float q1_dot = 0, q2_dot = 0;
float q1_dot_norm = 0, q2_dot_norm = 0;
const float veloBRW_pts[NUM_POINTS][3] PROGMEM = {
  { 0.940177, -0.270197, 0.207509 },
  { 0.424016, -0.895197, 0.137231 },
  { 0.488729, 0.676043, 0.551462 },
  { 0.745869, -0.651185, 0.140132 },
  { -0.282633, -0.653010, -0.702635 },
  { -0.229038, 0.005074, 0.973404 },
  { 0.572939, 0.190724, -0.797098 },
  { -0.139326, -0.371566, 0.917893 },
  { 0.204767, -0.926844, 0.314692 },
  { -0.166535, -0.986034, -0.001704 },
  { 0.392364, 0.178391, -0.902345 },
  { 0.121937, 0.991068, 0.054000 },
  { -0.131545, 0.633191, -0.762735 },
  { -0.362749, 0.488366, 0.793670 },
  { 0.520903, -0.820110, -0.236811 },
  { 0.223408, 0.042023, -0.973819 },
  { 0.780029, 0.475810, 0.406398 },
  { 0.278764, 0.044879, 0.959310 },
  { -0.606722, 0.483587, -0.630897 },
  { 0.097628, 0.680453, -0.726259 },
  { 0.996854, -0.069338, 0.038400 },
  { 0.842501, -0.138538, -0.520576 },
  { 0.360301, 0.260771, -0.895646 },
  { -0.075372, 0.341587, 0.936823 },
  { -0.437368, 0.150839, 0.886542 },
  { -0.497779, 0.064222, 0.864923 },
  { -0.832228, -0.543424, 0.109940 },
  { 0.710171, -0.402898, -0.577348 },
  { 0.138739, 0.257905, -0.956157 },
  { -0.970444, 0.202160, -0.131792 },
  { -0.501765, -0.049182, 0.863605 },
  { -0.779171, -0.156526, 0.606953 },
  { -0.172643, 0.335119, -0.926223 },
  { 0.868178, 0.286439, 0.405241 },
  { 0.117270, -0.906750, -0.405034 },
  { 0.312432, 0.764818, 0.563417 },
  { 0.342188, 0.841000, -0.419078 },
  { 0.990120, -0.089978, -0.107551 },
  { -0.983941, -0.157568, 0.083861 },
  { -0.041286, -0.449769, -0.892190 },
  { -0.575473, 0.708002, -0.409345 },
  { -0.593615, -0.024270, -0.804383 },
  { -0.777428, -0.474045, 0.413384 },
  { 0.562283, -0.825536, -0.048248 },
  { -0.725885, 0.478269, 0.494318 },
  { -0.542230, 0.727577, -0.420259 },
  { -0.816925, -0.406468, -0.409166 },
  { -0.097900, 0.253867, 0.962272 },
  { -0.582429, -0.801809, 0.133714 },
  { 0.825271, -0.123540, 0.551059 },
  { 0.080428, 0.969009, -0.233566 },
  { 0.295161, 0.729699, -0.616782 },
  { 0.222903, 0.534648, 0.815147 },
  { 0.885350, 0.034542, 0.463641 },
  { -0.233630, -0.101083, -0.967057 },
  { -0.354327, 0.585588, -0.729067 },
  { -0.836125, -0.096433, -0.539996 },
  { -0.422950, 0.903863, 0.064382 },
  { -0.208640, -0.592847, 0.777819 },
  { -0.052408, 0.112138, 0.992310 },
  { 0.593336, -0.606323, -0.529457 },
  { -0.448189, -0.873898, 0.188225 },
  { 0.561055, 0.775927, 0.288367 },
  { -0.084249, -0.523652, 0.847756 },
  { -0.664371, -0.194166, -0.721742 },
  { 0.263201, -0.898181, 0.352131 },
  { -0.789990, -0.586910, 0.177347 },
  { -0.045834, -0.945451, 0.322525 },
  { 0.861329, -0.031347, 0.507080 },
  { 0.470148, 0.413648, -0.779651 },
  { 0.646605, 0.757309, 0.091569 },
  { -0.180165, 0.951278, -0.250220 },
  { 0.249019, -0.293893, 0.922831 },
  { 0.085136, -0.399150, -0.912925 },
  { -0.743302, -0.317986, 0.588546 },
  { 0.961843, -0.161762, -0.220661 },
  { -0.019022, 0.013111, 0.999733 },
  { -0.700957, 0.665802, -0.255670 },
  { 0.209561, 0.969810, 0.124707 },
  { 0.036236, 0.927988, 0.370844 },
  { -0.259886, 0.380483, 0.887520 },
  { -0.055155, 0.520754, 0.851923 },
  { 0.897507, -0.424926, 0.117979 },
  { -0.761713, -0.029591, -0.647239 },
  { 0.501250, -0.710829, -0.493427 },
  { -0.856156, 0.376077, 0.354349 },
  { -0.519063, -0.854722, -0.004915 },
  { 0.686237, 0.718577, -0.112812 },
  { 0.086087, -0.592132, -0.801229 },
  { -0.716841, -0.412256, 0.562303 },
  { 0.821467, -0.545942, -0.164740 },
  { 0.901802, -0.336636, 0.270978 },
  { -0.664084, -0.654937, 0.360625 },
  { 0.747071, 0.611118, -0.261573 },
  { 0.170921, -0.628267, -0.758991 },
  { -0.196949, -0.660383, -0.724642 },
  { 0.432868, -0.041970, 0.900480 },
  { 0.262010, 0.404316, -0.876287 },
  { -0.864262, 0.496840, -0.078744 },
  { -0.993244, 0.003285, -0.116000 },
  { 0.667449, -0.069876, 0.741370 },
  { -0.933408, -0.333244, -0.133033 },
  { 0.092576, -0.672555, 0.734234 },
  { 0.266867, -0.764960, -0.586189 },
  { -0.348844, 0.479081, 0.805474 },
  { 0.183864, 0.599746, 0.778780 },
  { 0.744649, 0.031977, -0.666689 },
  { -0.961167, -0.249414, 0.118112 },
  { 0.713377, 0.254556, 0.652913 },
  { -0.155382, 0.226048, 0.961644 },
  { -0.874077, 0.304732, 0.378322 },
  { 0.429613, -0.900354, 0.069248 },
  { 0.662965, -0.405244, 0.629488 },
  { -0.788620, 0.182362, -0.587216 },
  { 0.088821, 0.996046, 0.001529 },
  { 0.512915, -0.766379, -0.386758 },
  { -0.923874, 0.296043, -0.242518 },
  { 0.916228, 0.339289, -0.213092 },
  { 0.319478, -0.931048, -0.176308 },
  { 0.000412, 0.522818, -0.852445 },
  { -0.730815, -0.258608, 0.631689 },
  { 0.643575, -0.342280, 0.684585 },
  { 0.332645, -0.859386, 0.388334 },
  { 0.559154, -0.341860, 0.755300 },
  { -0.892434, 0.021020, 0.450687 },
  { 0.752025, 0.639441, 0.159919 },
  { 0.207402, 0.639894, 0.739946 },
  { 0.918862, -0.261596, 0.295400 },
  { -0.781180, -0.295026, 0.550198 },
  { -0.636489, -0.002242, -0.771282 },
  { 0.968808, -0.231691, 0.087926 },
  { 0.881939, -0.372652, 0.288642 },
  { -0.467014, 0.884143, -0.013751 },
  { 0.846755, 0.477721, 0.234072 },
  { -0.065276, 0.353025, -0.933334 },
  { 0.004125, 0.666446, -0.745542 },
  { -0.350485, 0.343760, 0.871200 },
  { 0.767286, 0.634921, 0.090264 },
  { -0.846883, 0.496374, -0.190792 },
  { -0.159996, -0.720326, 0.674931 },
  { 0.415815, 0.886633, -0.202435 },
  { -0.742786, -0.240371, 0.624892 },
  { -0.187146, 0.959798, 0.209198 },
  { 0.183600, -0.624098, 0.759469 },
  { -0.554927, -0.612693, 0.562729 },
  { 0.315329, -0.785367, -0.532697 },
  { -0.444385, -0.233210, -0.864948 },
  { 0.276640, 0.848811, 0.450544 },
  { 0.147801, -0.955673, -0.254646 },
  { 0.522101, -0.114061, -0.845222 },
  { 0.836076, 0.323894, 0.442798 },
  { 0.736716, -0.496200, 0.459386 },
  { -0.563676, 0.799127, -0.208964 },
  { -0.066919, 0.056974, -0.996130 },
  { 0.065071, 0.731234, -0.679016 },
  { -0.656179, 0.623677, 0.424802 },
  { 0.889397, -0.273670, -0.366166 },
  { -0.067510, -0.141764, 0.987596 },
  { 0.180638, -0.870715, -0.457412 },
  { 0.479098, -0.214154, -0.851236 },
  { 0.609069, -0.253267, 0.751592 },
  { 0.314064, -0.426325, -0.848299 },
  { 0.717476, -0.679108, -0.155050 },
  { -0.482417, -0.852322, 0.202040 },
  { 0.568407, 0.409004, -0.713883 },
  { 0.445530, -0.115556, -0.887778 },
  { -0.934070, -0.072869, 0.349576 },
  { 0.253480, 0.299524, 0.919801 },
  { 0.150136, 0.962190, 0.227266 },
  { 0.010347, 0.994556, 0.103691 },
  { -0.144062, -0.659767, 0.737532 },
  { 0.472333, -0.613362, -0.633000 },
  { -0.733557, 0.526813, -0.429373 },
  { 0.369921, -0.604283, 0.705691 },
  { 0.183436, -0.978482, -0.094466 },
  { 0.719286, -0.653740, 0.235058 },
  { 0.604548, 0.515164, 0.607559 },
  { -0.693127, 0.071469, -0.717264 },
  { -0.946163, 0.224291, -0.233388 },
  { 0.205744, 0.728670, -0.653230 },
  { -0.002270, -0.711915, 0.702262 },
  { -0.145880, 0.978136, 0.148220 },
  { 0.671992, 0.179858, -0.718385 },
  { -0.667079, 0.552127, 0.500160 },
  { 0.639393, 0.703618, 0.309995 },
  { -0.390793, 0.057274, 0.918695 },
  { 0.824859, -0.413246, 0.385792 },
  { 0.141787, 0.832096, -0.536202 },
  { 0.918955, -0.296892, 0.259571 },
  { 0.872713, 0.466542, 0.143911 },
  { 0.053436, -0.286744, 0.956516 },
  { 0.265304, -0.559243, -0.785405 },
  { 0.629486, 0.072308, 0.773640 },
  { 0.072867, 0.980794, 0.180924 },
  { -0.710636, -0.051513, 0.701672 },
  { -0.807434, 0.295330, -0.510715 },
  { -0.818305, -0.563176, -0.114928 },
  { 0.726871, -0.666022, 0.167548 },
  { -0.549959, -0.771789, 0.319197 },
  { -0.332469, 0.712991, -0.617340 },
  { 0.995914, 0.090211, -0.004157 },
  { -0.486964, 0.200610, -0.850071 },
  { 0.773642, 0.425504, -0.469494 },
  { -0.660417, -0.727956, -0.184200 },
  { 0.912818, -0.219998, -0.344042 },
  { 0.931833, -0.331359, 0.147949 },
  { -0.561630, 0.291644, 0.774284 },
  { 0.347700, -0.932018, -0.102213 },
  { 0.080267, -0.607718, 0.790086 },
  { -0.220598, 0.701777, 0.677382 },
  { 0.463344, 0.080638, -0.882502 },
  { 0.612096, 0.782960, -0.110956 },
  { -0.421720, 0.893653, 0.153416 },
  { 0.213107, -0.934299, 0.285780 },
  { 0.389512, -0.898829, 0.200963 },
  { 0.411667, -0.891520, 0.189005 },
  { 0.751547, 0.446271, 0.485817 },
  { -0.333196, -0.770890, -0.542871 },
  { 0.281360, -0.481515, 0.830048 },
  { -0.218422, 0.189023, 0.957373 },
  { 0.815151, -0.535933, 0.219783 },
  { -0.131792, 0.563014, 0.815871 },
  { 0.794981, -0.353590, -0.492929 },
  { -0.735670, 0.612039, -0.290168 },
  { 0.549093, 0.781829, 0.295366 },
  { -0.796835, 0.569519, 0.201749 },
  { -0.989763, -0.013444, 0.142086 },
  { -0.507203, 0.725856, 0.464627 },
  { -0.637017, -0.614251, 0.465731 },
  { 0.042568, 0.921719, 0.385514 },
  { -0.496411, -0.369794, -0.785384 },
  { -0.108439, 0.986584, -0.122034 },
  { 0.930682, 0.165080, 0.326466 },
  { 0.200696, 0.647655, -0.735027 },
  { -0.433075, 0.899081, -0.064020 },
  { -0.368690, 0.916472, 0.155394 },
  { 0.567692, 0.209236, 0.796207 },
  { 0.012205, 0.109632, 0.993897 },
  { 0.495175, -0.695550, -0.520588 },
  { 0.679698, -0.261059, 0.685463 },
  { -0.063526, -0.790130, 0.609639 },
  { -0.291018, 0.861455, 0.416177 },
  { 0.716009, 0.569477, 0.403767 },
  { -0.399511, -0.868256, -0.294148 },
  { -0.901209, -0.404263, -0.156182 },
  { -0.842646, 0.006262, -0.538431 },
  { 0.608180, -0.558793, 0.563797 },
  { 0.545598, 0.606067, -0.578797 },
  { 0.127458, -0.673423, 0.728187 },
  { -0.708886, 0.482080, 0.514859 },
  { -0.119845, -0.985876, -0.116986 },
  { -0.838902, -0.437077, -0.324357 },
  { 0.931447, -0.295705, 0.212048 },
  { 0.412586, -0.458400, -0.787173 },
  { 0.477134, 0.835277, -0.273231 },
  { 0.478478, -0.044630, -0.876964 },
  { 0.799149, -0.601132, 0.001204 },
  { 0.326315, 0.925109, 0.194143 },
  { -0.539616, -0.296129, 0.788113 },
  { 0.558315, 0.794518, -0.238800 },
  { -0.347476, -0.684260, -0.641131 },
  { 0.256275, 0.720360, 0.644519 },
  { -0.339443, -0.186497, -0.921953 },
  { -0.176799, 0.735600, 0.653937 },
  { -0.537817, -0.582797, 0.609180 },
  { -0.029361, 0.820952, 0.570242 },
  { 0.807297, -0.472774, 0.353208 },
  { -0.612028, 0.781686, 0.119950 },
  { 0.499581, 0.866144, 0.014635 },
  { 0.900724, 0.404287, -0.158898 },
  { 0.505407, -0.861121, 0.055089 },
  { -0.906845, 0.127193, -0.401813 },
  { 0.647041, -0.447109, -0.617602 },
  { -0.918328, -0.141964, -0.369487 },
  { 0.044179, -0.448389, 0.892746 },
  { 0.048569, 0.979264, 0.196679 },
  { 0.858071, 0.060944, -0.509901 },
  { -0.910396, 0.172656, 0.375991 },
  { -0.127430, 0.918826, 0.373524 },
  { -0.067358, -0.988333, 0.136601 },
  { 0.811391, -0.135566, 0.568566 },
  { 0.742907, 0.604197, 0.288158 },
  { 0.322491, 0.004159, 0.946563 },
  { -0.330340, 0.140684, 0.933319 },
  { 0.598440, 0.771371, -0.216464 },
  { -0.889436, -0.435687, -0.138136 },
  { 0.624093, -0.632922, -0.458168 },
  { 0.679309, 0.730880, -0.065975 },
  { 0.753072, -0.163869, 0.637204 },
  { 0.291816, 0.683744, -0.668833 },
  { -0.549926, -0.772040, -0.318646 },
  { -0.783205, 0.521970, 0.337843 },
  { 0.146812, -0.390451, -0.908842 },
  { -0.225173, 0.860748, 0.456519 },
  { -0.312564, -0.624514, 0.715742 },
  { -0.392648, -0.070255, -0.917002 },
  { -0.642590, -0.658719, 0.391365 },
  { -0.300222, -0.824494, -0.479663 },
  { -0.833745, -0.543223, 0.098879 },
  { -0.906850, -0.033520, -0.420118 },
  { 0.499275, 0.562393, 0.659119 },
  { -0.536291, 0.787337, 0.304126 },
  { -0.335815, 0.917626, 0.212583 },
  { 0.335802, -0.658128, -0.673873 },
  { 0.233266, -0.786435, -0.571932 },
  { 0.049144, 0.294603, 0.954355 },
  { -0.603598, 0.416346, 0.679945 },
  { -0.124398, 0.358495, -0.925206 },
  { -0.489087, 0.866241, -0.102080 },
  { -0.607949, -0.707137, 0.361046 },
  { 0.812093, 0.530845, 0.242298 },
  { 0.018279, -0.989952, -0.140214 },
  { 0.396463, -0.540591, 0.742010 },
  { 0.554328, -0.409872, -0.724380 },
  { 0.561727, 0.638640, -0.525929 },
  { 0.270483, -0.884477, 0.380183 },
  { -0.183435, -0.259426, 0.948182 },
  { 0.720840, -0.408464, -0.559952 },
  { -0.647082, 0.699145, 0.304107 },
  { -0.360176, -0.249054, -0.899024 },
  { -0.909599, 0.415041, -0.019252 },
  { 0.802476, -0.557789, 0.211905 },
  { 0.588906, -0.725984, -0.355156 },
  { -0.061708, -0.936587, -0.344959 },
  { -0.513710, 0.687435, -0.513356 },
  { -0.592439, -0.653863, 0.470615 },
  { 0.444410, 0.880664, -0.164103 },
  { -0.734167, -0.445542, 0.512340 },
  { -0.811276, 0.357041, 0.462983 },
  { -0.642784, -0.651556, 0.402870 },
  { 0.657771, 0.721091, 0.217635 },
  { -0.130392, 0.971025, -0.200272 },
  { 0.634147, -0.145862, 0.759330 },
  { -0.256557, -0.812138, 0.524032 },
  { -0.857585, -0.501938, 0.112278 },
  { 0.278697, 0.430615, -0.858428 },
  { 0.816271, -0.084879, -0.571400 },
  { 0.387785, 0.230415, 0.892486 },
  { 0.899035, 0.230473, 0.372313 },
  { -0.417985, 0.874639, 0.245549 },
  { -0.113561, -0.577149, 0.808704 },
  { -0.784465, 0.617547, -0.057015 },
  { -0.078301, 0.917251, -0.390539 },
  { -0.409192, -0.908851, 0.080939 },
  { -0.223230, 0.363312, 0.904529 },
  { 0.679362, 0.028232, 0.733260 },
  { 0.940396, 0.195513, -0.278262 },
  { -0.538907, 0.547105, 0.640512 },
  { -0.790878, -0.392086, 0.469872 },
  { -0.757230, 0.381857, 0.529895 },
  { 0.340682, 0.752558, -0.563553 },
  { 0.344562, 0.576241, -0.741096 },
  { 0.892269, 0.254268, 0.373100 },
  { -0.617317, -0.762653, 0.193079 },
  { 0.810997, 0.558728, -0.173513 },
  { -0.253464, 0.051421, -0.965977 },
  { 0.393096, 0.919462, 0.008025 },
  { -0.668931, 0.678668, 0.303217 },
  { -0.612968, -0.789426, 0.032810 },
  { 0.656379, -0.339883, 0.673532 },
  { 0.104329, -0.584007, -0.805016 },
  { 0.484110, 0.378414, 0.788949 },
  { -0.758298, 0.147493, 0.635004 },
  { 0.778259, -0.374251, -0.504232 },
  { 0.752638, -0.488623, 0.441342 },
  { 0.319035, 0.935094, 0.154327 },
  { -0.239537, 0.831236, -0.501666 },
  { -0.688018, 0.239425, -0.685060 },
  { -0.054258, -0.018727, -0.998351 },
  { 0.263696, -0.701315, 0.662285 },
  { 0.215926, -0.814425, -0.538599 },
  { 0.455431, -0.322028, 0.829988 },
  { 0.243095, 0.210411, -0.946906 },
  { 0.855914, -0.497620, 0.140663 },
  { -0.554853, -0.818230, 0.150460 },
  { 0.368188, 0.915543, -0.161920 },
  { 0.095112, -0.189042, 0.977352 },
  { -0.417426, 0.096616, 0.903560 },
  { -0.592806, 0.099860, 0.799130 },
  { -0.737273, 0.673771, -0.049610 },
  { -0.679486, -0.038351, -0.732686 },
  { -0.528832, -0.388490, 0.754594 },
  { -0.216552, 0.264630, -0.939721 },
  { 0.257700, 0.894972, 0.364166 },
  { 0.767348, 0.476815, 0.428749 },
  { 0.143584, -0.895756, 0.420719 },
  { 0.719941, -0.671069, -0.177064 },
  { -0.139572, 0.925985, 0.350815 },
  { 0.747482, -0.095232, 0.657420 },
  { 0.397472, 0.594662, 0.698851 },
  { -0.999830, -0.017181, 0.006757 },
  { -0.479483, -0.059564, -0.875528 },
  { -0.220309, 0.209897, 0.952579 },
  { -0.105170, -0.765975, -0.634210 },
  { 0.974220, 0.191187, -0.119758 },
  { 0.843339, -0.162850, 0.512112 },
  { -0.784442, 0.098846, -0.612275 },
  { 0.650667, 0.366527, 0.665050 },
  { 0.763598, 0.550929, -0.336742 },
  { -0.063387, -0.028499, 0.997582 },
  { 0.421986, -0.742266, 0.520547 },
  { -0.077237, 0.058136, -0.995316 },
  { 0.248218, -0.601489, 0.759341 },
  { 0.445080, 0.320901, 0.836018 },
  { -0.455073, -0.751283, -0.477998 },
  { 0.675754, 0.632612, -0.378362 },
  { 0.639718, -0.555556, -0.531148 },
  { -0.925549, -0.362152, 0.110479 },
  { 0.543022, 0.837235, -0.064529 },
  { -0.951506, 0.004666, -0.307593 },
  { 0.756572, 0.623426, 0.197329 },
  { -0.520976, -0.006145, -0.853549 },
  { 0.713122, 0.699309, 0.049235 },
  { -0.474833, 0.136648, -0.869402 },
  { 0.945837, 0.218099, 0.240471 },
  { -0.505784, -0.324871, -0.799150 },
  { -0.946385, -0.291823, -0.138544 },
  { 0.294028, -0.456950, 0.839490 },
  { 0.526250, -0.581160, -0.620736 },
  { 0.249414, 0.963327, -0.098958 },
  { -0.357288, -0.930191, -0.084202 },
  { 0.667353, 0.490674, 0.560249 },
  { -0.717530, -0.466895, -0.516875 },
  { 0.076599, -0.386279, 0.919196 },
  { -0.836886, -0.437090, -0.329505 },
  { -0.516399, -0.685365, -0.513426 },
  { 0.132871, -0.067765, 0.988814 },
  { 0.775209, 0.624061, 0.097975 },
  { -0.438334, -0.508711, 0.740997 },
  { -0.864095, -0.335279, -0.375404 },
  { 0.672264, -0.518656, -0.528258 },
  { 0.132192, -0.786406, 0.603400 },
  { -0.013600, -0.620370, -0.784191 },
  { -0.783374, -0.154865, 0.601948 },
  { 0.861806, 0.479636, 0.165043 },
  { -0.441076, -0.848616, 0.292067 },
  { -0.043059, -0.476274, -0.878242 },
  { -0.664808, 0.488596, 0.565071 },
  { -0.436133, -0.846143, -0.306317 },
  { 0.285265, -0.735008, 0.615131 },
  { 0.196198, 0.838483, 0.508382 },
  { 0.875173, 0.253779, 0.411909 },
  { -0.860885, 0.182509, -0.474940 },
  { 0.278133, 0.578266, 0.766975 },
  { 0.204217, -0.476638, -0.855051 },
  { -0.210534, 0.974600, -0.076360 },
  { -0.868656, -0.495315, -0.009952 },
  { -0.201445, -0.668818, -0.715614 },
  { 0.748022, 0.069957, 0.659977 },
  { -0.044984, 0.980159, -0.193041 },
  { -0.646309, -0.377361, 0.663237 },
  { -0.154928, 0.984992, -0.076083 },
  { -0.004968, -0.631709, 0.775190 },
  { -0.420670, 0.886733, 0.191680 },
  { 0.223420, 0.945593, -0.236510 },
  { 0.631748, 0.603540, -0.486449 },
  { -0.496111, -0.868130, -0.014984 },
  { 0.504713, -0.862705, 0.031688 },
  { 0.103425, -0.548311, 0.829854 },
  { -0.722317, -0.623448, 0.299282 },
  { 0.786993, 0.123111, -0.604554 },
  { -0.671030, -0.328408, 0.664731 },
  { -0.915132, 0.360419, -0.180645 },
  { -0.792368, -0.502853, -0.345385 },
  { -0.626368, -0.089204, -0.774407 },
  { -0.264749, -0.465076, -0.844756 },
  { -0.052158, 0.978059, -0.201693 },
  { -0.056523, 0.994993, 0.082428 },
  { -0.055082, -0.128514, -0.990177 },
  { -0.198560, 0.890857, 0.408592 },
  { -0.931669, -0.070360, 0.356429 },
  { -0.115386, 0.150927, 0.981788 },
  { 0.210396, -0.709972, -0.672066 },
  { 0.075094, -0.916470, 0.392994 },
  { -0.272279, -0.567245, -0.777237 },
  { 0.156113, 0.121949, 0.980182 },
  { 0.404868, 0.581486, -0.705660 },
  { 0.112065, 0.279941, -0.953454 },
  { -0.372918, -0.536139, 0.757289 },
  { 0.322431, -0.319330, -0.891104 },
  { -0.297082, -0.907654, 0.296490 },
  { -0.557464, -0.819925, 0.130221 },
  { 0.000549, -0.482039, -0.876150 },
  { -0.872832, 0.001991, -0.488017 },
  { -0.896859, 0.405720, 0.176170 },
  { 0.909510, -0.224247, 0.350006 },
  { 0.579315, 0.693176, -0.428837 },
  { -0.252734, 0.964313, 0.078901 },
  { 0.864419, 0.119793, 0.488293 },
  { 0.289133, 0.494902, 0.819435 },
  { 0.058924, -0.672853, -0.737426 },
  { -0.949858, -0.166633, -0.264581 },
  { -0.868246, 0.318288, 0.380581 },
  { -0.528067, 0.849032, -0.017046 },
  { -0.238460, 0.426192, -0.872638 },
  { 0.750946, 0.659860, -0.025762 },
  { 0.925055, 0.005623, -0.379791 },
  { -0.999817, 0.014905, -0.012001 },
  { 0.326793, 0.049033, 0.943823 },
  { -0.016286, 0.928093, 0.371992 },
  { 0.019800, -0.286869, 0.957765 },
  { 0.954295, -0.201973, -0.220290 },
  { 0.779231, -0.345853, -0.522672 },
  { -0.692548, -0.049762, 0.719654 },
  { 0.767966, 0.036334, 0.639460 },
  { -0.417504, 0.410733, 0.810548 },
  { -0.795010, 0.526774, -0.300780 },
  { -0.990061, 0.135515, 0.037628 },
  { 0.956582, -0.096886, -0.274890 },
  { 0.679333, 0.505422, -0.532029 },
  { -0.453321, -0.750977, -0.480140 },
  { 0.345359, 0.936942, -0.053541 },
  { 0.730451, 0.060222, 0.680305 },
  { -0.700852, 0.019172, 0.713049 },
  { 0.908175, 0.064732, -0.413555 },
  { 0.669125, 0.048024, -0.741597 },
  { 0.881158, -0.318788, 0.349192 },
  { -0.949991, 0.292667, -0.108916 },
  { -0.038707, 0.616879, 0.786106 },
  { 0.776819, -0.202951, -0.596124 },
  { 0.699021, -0.704312, 0.123753 },
  { -0.754169, -0.638009, 0.155476 },
  { 0.143238, 0.925137, 0.351575 },
  { -0.691698, -0.140925, 0.708304 },
  { 0.920229, 0.259101, 0.293336 },
  { 0.120809, -0.303840, 0.945032 },
  { 0.647462, -0.607029, -0.460771 },
  { 0.732820, -0.099912, -0.673047 },
  { -0.646232, 0.204094, -0.735344 },
  { 0.811269, -0.398988, -0.427377 },
  { -0.494928, 0.152863, -0.855382 },
  { -0.241951, -0.968717, 0.055203 },
  { 0.649695, 0.756182, -0.078012 },
  { -0.101412, -0.459064, -0.882596 },
  { 0.013931, -0.996301, 0.084789 },
  { 0.186940, -0.751675, -0.632486 },
  { 0.702293, -0.131065, 0.699719 },
  { -0.488953, -0.490909, 0.721064 },
  { -0.635212, -0.165125, 0.754480 },
  { -0.434411, -0.493325, -0.753603 },
  { -0.205963, 0.343560, -0.916267 },
  { -0.611184, -0.783232, -0.114021 },
  { 0.356572, -0.901225, 0.246272 },
  { -0.336748, 0.322554, 0.884624 },
  { -0.707125, 0.038388, 0.706045 },
  { 0.834502, -0.067108, -0.546903 },
  { 0.570196, -0.386743, 0.724780 },
  { -0.713691, 0.693067, -0.101510 },
  { -0.917669, 0.373122, -0.136619 },
  { -0.796471, 0.025232, -0.604151 },
  { -0.953808, 0.270044, 0.131631 },
  { -0.353947, 0.441503, -0.824498 },
  { -0.429468, 0.083305, -0.899231 },
  { 0.401893, 0.035131, 0.915012 },
  { -0.443553, -0.507331, -0.738834 },
  { 0.262771, -0.731497, 0.629176 },
  { 0.967414, -0.132061, -0.216033 },
  { -0.908780, -0.416609, 0.023564 },
  { 0.134294, -0.110791, -0.984729 },
  { -0.888311, 0.214378, 0.406136 },
  { -0.038988, 0.792993, 0.607982 },
  { 0.490787, 0.834441, -0.250673 },
  { 0.941883, -0.135243, 0.307517 },
  { -0.405766, 0.834680, -0.372375 },
  { 0.958520, 0.045883, 0.281309 },
  { 0.095619, -0.995394, 0.006978 },
  { 0.041213, -0.909995, -0.412565 },
  { 0.996025, -0.087694, -0.015647 },
  { 0.804054, -0.275475, 0.526887 },
  { 0.474384, 0.731833, 0.489265 },
  { 0.175750, -0.139267, 0.974534 },
  { -0.671897, 0.651655, 0.351994 },
  { -0.740494, -0.335990, -0.582048 },
  { -0.766967, 0.638235, 0.066468 },
  { 0.494270, -0.031603, 0.868734 },
  { -0.655163, -0.259504, -0.709520 },
  { 0.102178, -0.905900, -0.410980 },
  { 0.892981, 0.044606, -0.447878 },
  { 0.088635, 0.922164, 0.376507 },
  { 0.764422, 0.502446, 0.403989 },
  { -0.777669, -0.285321, 0.560199 },
  { 0.966657, -0.150599, -0.207111 },
  { -0.701483, 0.711666, -0.038124 },
  { 0.231827, -0.921661, 0.311121 },
  { -0.683463, -0.583662, 0.438426 },
  { -0.589945, 0.415762, -0.692176 },
  { -0.579834, 0.621747, 0.526520 },
  { 0.700137, -0.013723, -0.713877 },
  { -0.700907, 0.421499, 0.575385 },
  { 0.837401, 0.088535, -0.539371 },
  { -0.477781, 0.677080, -0.559721 },
  { -0.037656, 0.907238, -0.418929 },
  { 0.647693, 0.434638, 0.625766 },
  { 0.088344, -0.793744, 0.601803 },
  { -0.848424, 0.051580, -0.526799 },
  { -0.272481, 0.780631, 0.562467 },
  { -0.959302, -0.227522, 0.167253 },
  { 0.419067, 0.603586, -0.678283 },
  { -0.349501, 0.670356, -0.654578 },
  { 0.355428, -0.773361, 0.524961 },
  { -0.522082, -0.134619, 0.842204 },
  { -0.287310, 0.233626, -0.928909 },
  { -0.814544, -0.194842, 0.546401 },
  { 0.443279, 0.825442, 0.349499 },
  { 0.054767, 0.976919, -0.206471 },
  { -0.830655, -0.285314, 0.478130 },
  { 0.891553, -0.452207, 0.025331 },
  { 0.524893, 0.850231, -0.039932 },
  { 0.706485, 0.678761, 0.200404 },
  { -0.928404, -0.070706, 0.364784 },
  { 0.886041, -0.413265, 0.210103 },
  { 0.425258, -0.853183, -0.302049 },
  { -0.374962, 0.511723, 0.773009 },
  { -0.608540, -0.744944, 0.273383 },
  { 0.355554, 0.930498, 0.088060 },
  { -0.679834, -0.090116, -0.727808 },
  { -0.550740, -0.603821, 0.576268 },
  { -0.603498, -0.281588, 0.745989 },
  { -0.586511, -0.538846, -0.604690 },
  { -0.857218, -0.514285, -0.026237 },
  { 0.335613, -0.870931, 0.358946 },
  { -0.481574, -0.864939, -0.141306 },
  { 0.753399, -0.552392, -0.356725 },
  { 0.837224, 0.523541, 0.157991 },
  { 0.430779, -0.381876, 0.817680 },
  { 0.436395, 0.430681, 0.789983 },
  { -0.063663, 0.667348, 0.742020 },
  { -0.311263, -0.414413, 0.855206 },
  { 0.429995, 0.504115, -0.748981 },
  { -0.783539, -0.568848, -0.249956 },
  { 0.441565, -0.452118, -0.774991 },
  { 0.709921, -0.225793, -0.667106 },
  { 0.938987, 0.342806, -0.028053 },
  { 0.198600, -0.957433, 0.209478 },
  { -0.863562, 0.367371, 0.345396 },
  { -0.606297, 0.724193, -0.328554 },
  { -0.332956, -0.657237, 0.676151 },
  { 0.492340, -0.550103, -0.674528 },
  { -0.708798, 0.226901, 0.667924 },
  { 0.956593, 0.181981, 0.227623 },
  { -0.031696, 0.480976, 0.876160 },
  { 0.933819, -0.257149, -0.248710 },
  { -0.382307, 0.336247, -0.860685 },
  { 0.479859, 0.590612, -0.648778 },
  { -0.861065, 0.049998, -0.506030 },
  { 0.406313, -0.744239, 0.530111 },
  { -0.527760, -0.347923, -0.774867 },
  { -0.017883, -0.984461, -0.174691 },
  { 0.744382, 0.054005, 0.665566 },
  { 0.247428, 0.857654, 0.450787 },
  { -0.559096, -0.811150, 0.171603 },
  { 0.457638, -0.873843, -0.164216 },
  { -0.769369, 0.608768, 0.193581 },
  { 0.424396, -0.612093, 0.667255 },
  { 0.289376, 0.188833, -0.938405 },
  { -0.240506, 0.287408, 0.927121 },
  { 0.716270, -0.359976, -0.597807 },
  { 0.070584, -0.990961, 0.114082 },
  { -0.067228, -0.909066, 0.411193 },
  { 0.340127, 0.036032, 0.939689 },
  { -0.116414, 0.238568, 0.964123 },
  { -0.006769, -0.783843, -0.620923 },
  { -0.212289, -0.124620, -0.969228 },
  { 0.809764, -0.571771, -0.131757 },
  { 0.922512, 0.223954, 0.314352 },
  { 0.260498, -0.795565, 0.547007 },
  { 0.048710, 0.644358, 0.763171 },
  { -0.977860, 0.196447, 0.072103 },
  { -0.785279, 0.359779, -0.503881 },
  { -0.330744, -0.767681, -0.548885 },
  { -0.724555, 0.673820, 0.144864 },
  { 0.191032, 0.741880, -0.642745 },
  { -0.815304, -0.573530, 0.079644 },
  { -0.979877, 0.190521, 0.059528 },
  { -0.723494, -0.279536, -0.631202 },
  { -0.062213, -0.235875, 0.969790 },
  { 0.840960, 0.192102, -0.505849 },
  { 0.497906, -0.826833, -0.261602 },
  { -0.136742, -0.107743, 0.984730 },
  { 0.971743, 0.065700, 0.226715 },
  { 0.511444, -0.504826, 0.695396 },
  { -0.350089, -0.874449, 0.335823 },
  { 0.244851, 0.936476, 0.251119 },
  { -0.634594, 0.734914, 0.239147 },
  { 0.986020, 0.157346, 0.054836 },
  { -0.403030, -0.908638, 0.109286 },
  { 0.432824, 0.173299, 0.884664 },
  { 0.800715, -0.464168, -0.378687 },
  { 0.499667, -0.350721, -0.792040 },
  { -0.909778, -0.062241, -0.410403 },
  { 0.684748, 0.725379, -0.070321 },
  { -0.467063, 0.169696, -0.867788 },
  { -0.304733, 0.947778, -0.094097 },
  { -0.851882, 0.185808, 0.489665 },
  { -0.205666, -0.595911, -0.776268 },
  { -0.862185, -0.452925, 0.226926 },
  { -0.107574, -0.304168, -0.946525 },
  { -0.371716, -0.252652, -0.893305 },
  { 0.097503, 0.817680, 0.567356 },
  { 0.602983, -0.796587, 0.043145 },
  { 0.674258, 0.257319, 0.692216 },
  { -0.096486, -0.370563, -0.923782 },
  { 0.751359, 0.433152, -0.497835 },
  { 0.668509, -0.722924, 0.174576 },
  { -0.458594, -0.847062, 0.268659 },
  { -0.004376, -0.689611, -0.724167 },
  { 0.346136, -0.909420, -0.230534 },
  { -0.793631, -0.275627, -0.542384 },
  { -0.792301, 0.582295, -0.182187 },
  { -0.486978, -0.498311, 0.717314 },
  { 0.795400, 0.332470, 0.506757 },
  { 0.905406, 0.305628, 0.294671 },
  { 0.389344, -0.912032, 0.128876 },
  { -0.335604, 0.828752, -0.447818 },
  { 0.690117, 0.506854, 0.516564 },
  { 0.954466, -0.205128, 0.216602 },
  { -0.563507, 0.589724, 0.578520 },
  { -0.575192, -0.568188, -0.588487 },
  { 0.211036, -0.951710, 0.222960 },
  { -0.585460, 0.755422, 0.294234 },
  { 0.433731, 0.503978, 0.746916 },
  { -0.766194, 0.611009, 0.199033 },
  { 0.503991, 0.021584, 0.863439 },
  { 0.006804, 0.428319, 0.903602 },
  { -0.552451, -0.787031, 0.274553 },
  { -0.925987, -0.369663, -0.076795 },
  { -0.071041, 0.282100, -0.956751 },
  { 0.559891, -0.805138, 0.195640 },
  { -0.358988, 0.116655, 0.926024 },
  { 0.365384, -0.187186, 0.911842 },
  { 0.082193, -0.854612, -0.512721 },
  { 0.411115, -0.241182, -0.879099 },
  { 0.204537, -0.701722, 0.682460 },
  { -0.236051, 0.876970, -0.418573 },
  { -0.962995, 0.268870, 0.018685 },
  { -0.748836, -0.397281, 0.530483 },
  { 0.394250, 0.349249, 0.850054 },
  { -0.327506, -0.395001, -0.858320 },
  { -0.096026, 0.872362, -0.479336 },
  { -0.923095, -0.356838, 0.143395 },
  { 0.031438, -0.989193, 0.143209 },
  { 0.609811, -0.404169, -0.681746 },
  { -0.237066, -0.030953, 0.971000 },
  { -0.617114, 0.106206, 0.779673 },
  { 0.930372, -0.263701, 0.254697 },
  { 0.910587, 0.163408, 0.379644 },
  { -0.246538, -0.791738, -0.558901 },
  { -0.147282, 0.948029, 0.282046 },
  { 0.147019, 0.490454, 0.858976 },
  { 0.588029, 0.111640, 0.801099 },
  { 0.917346, 0.395434, -0.045914 },
  { 0.668650, -0.198754, -0.716522 },
  { -0.496250, -0.821051, 0.282153 },
  { 0.515550, -0.372275, -0.771764 },
  { -0.976833, 0.105341, -0.186282 },
  { 0.133302, -0.701216, 0.700376 },
  { -0.384520, -0.873513, -0.298530 },
  { -0.036308, 0.415948, -0.908663 },
  { 0.511651, -0.114234, -0.851566 },
  { 0.819828, -0.347344, 0.455229 },
  { -0.108248, 0.654756, 0.748049 },
  { 0.175850, 0.829882, 0.529503 },
  { -0.242845, 0.322644, -0.914837 },
  { -0.387448, -0.050576, 0.920503 },
  { 0.690703, -0.391849, 0.607770 },
  { -0.346407, -0.329551, -0.878293 },
  { 0.439401, 0.516584, 0.734893 },
  { -0.789039, -0.157927, -0.593697 },
  { 0.106393, -0.993230, -0.046641 },
  { 0.938405, -0.243123, -0.245533 },
  { 0.336495, -0.775877, -0.533653 },
  { -0.739014, 0.229223, -0.633494 },
  { 0.946308, -0.274337, 0.170996 },
  { -0.510696, 0.839084, -0.187427 },
  { -0.910845, 0.107046, -0.398625 },
  { -0.178744, 0.427859, 0.885995 },
  { 0.367627, 0.624305, -0.689271 },
  { -0.620358, 0.558330, 0.550839 },
  { 0.502135, -0.810129, -0.302574 },
  { 0.319009, -0.430806, 0.844180 },
  { 0.538947, -0.065314, -0.839804 },
  { 0.875816, 0.028335, 0.481813 },
  { 0.990227, 0.057027, 0.127273 },
  { -0.908294, 0.342091, -0.240783 },
  { -0.178950, 0.688905, 0.702415 },
  { -0.787762, 0.611897, -0.070804 },
  { -0.644187, 0.744339, -0.176021 },
  { -0.496537, -0.330663, -0.802566 },
  { -0.717103, -0.206518, -0.665668 },
  { 0.848183, -0.192549, -0.493468 },
  { 0.527106, -0.302375, 0.794184 },
  { 0.271072, 0.201163, -0.941304 },
  { -0.343024, 0.612125, 0.712487 },
  { -0.257006, -0.440654, 0.860100 },
  { -0.630253, 0.775287, 0.041356 },
  { -0.466613, 0.722810, -0.509724 },
  { 0.894295, -0.201909, 0.399336 },
  { 0.721398, 0.058328, -0.690060 },
  { 0.629604, -0.674555, -0.385454 },
  { 0.615223, 0.235876, 0.752239 },
  { 0.435419, -0.630293, 0.642760 },
  { 0.685386, -0.114151, -0.719177 },
  { 0.518904, 0.748438, -0.413013 },
  { 0.258659, -0.404334, 0.877274 },
  { 0.864142, 0.332558, -0.377708 },
  { -0.809683, -0.100836, -0.578140 },
  { -0.868311, 0.364750, -0.336146 },
  { 0.311524, -0.949491, -0.037679 },
  { 0.768554, 0.635578, -0.073250 },
  { -0.696302, -0.239614, -0.676572 },
  { -0.070292, 0.307729, 0.948874 },
  { 0.545207, 0.000733, -0.838301 },
  { -0.594542, -0.030100, 0.803501 },
  { -0.774882, -0.141561, 0.616050 },
  { 0.533988, -0.641755, -0.550462 },
  { -0.465396, 0.077547, -0.881699 },
  { -0.090977, -0.693405, 0.714782 },
  { -0.515141, 0.846495, 0.134450 },
  { -0.578651, 0.789991, 0.202676 },
  { 0.985645, 0.139163, 0.095595 },
  { 0.057205, -0.507502, 0.859750 },
  { -0.610528, -0.776616, -0.155316 },
  { 0.180370, 0.970364, -0.160811 },
  { -0.874435, 0.191172, 0.445888 },
  { 0.731016, -0.635308, -0.248998 },
  { -0.163592, -0.865052, 0.474261 },
  { 0.965408, -0.237368, -0.107901 },
  { 0.114237, 0.986854, -0.114323 },
  { 0.689469, 0.722231, 0.054903 },
  { -0.970664, -0.090915, 0.222590 },
  { 0.881682, 0.266732, 0.389217 },
  { -0.264301, -0.855758, -0.444774 },
  { 0.861341, 0.329857, 0.386375 },
  { -0.301641, -0.239022, 0.922974 },
  { -0.965132, 0.238202, -0.108539 },
  { -0.015776, -0.071205, 0.997337 },
  { 0.701859, -0.203574, -0.682607 },
  { 0.285663, 0.079332, -0.955041 },
  { -0.293383, -0.565532, -0.770779 },
  { -0.482288, 0.827151, -0.288479 },
  { -0.931343, -0.021963, -0.363480 },
  { -0.665800, -0.517693, -0.537312 },
  { -0.649274, -0.759998, 0.029093 },
  { -0.528487, -0.443069, -0.724148 },
  { -0.803833, -0.453048, 0.385486 },
  { 0.173990, -0.900602, 0.398301 },
  { 0.900461, 0.434867, 0.007831 },
  { 0.990019, -0.140925, -0.001748 },
  { 0.387857, 0.911583, 0.136322 },
  { 0.001073, -0.497445, -0.867495 },
  { -0.338286, 0.906818, -0.251482 },
  { -0.311683, 0.272426, 0.910295 },
  { 0.567252, 0.435711, -0.698843 },
  { -0.857949, -0.491565, 0.149289 },
  { -0.998313, 0.036197, 0.045394 },
  { 0.802405, 0.138783, -0.580419 },
  { 0.435264, -0.261843, -0.861385 },
  { -0.267577, -0.606999, 0.748301 },
  { -0.736223, -0.601146, 0.310805 },
  { 0.640298, 0.701317, 0.313326 },
  { 0.294492, 0.940958, 0.166951 },
  { -0.155431, -0.919379, -0.361363 },
  { -0.598898, -0.303577, 0.741055 },
  { -0.310457, 0.101887, 0.945112 },
  { 0.717880, -0.474484, 0.509425 },
  { 0.809565, -0.194599, 0.553837 },
  { -0.862827, -0.329280, 0.383541 },
  { -0.985095, -0.061225, -0.160746 },
  { 0.494927, 0.782307, -0.378211 },
  { 0.533396, -0.638952, -0.554283 },
  { -0.641974, -0.766209, -0.028174 },
  { -0.127895, 0.855421, 0.501894 },
  { -0.711626, -0.655729, 0.252206 },
  { -0.416263, -0.891169, -0.180395 },
  { -0.499404, -0.866359, -0.004297 },
  { -0.024459, 0.093915, 0.995280 },
  { -0.521497, 0.225038, -0.823042 },
  { -0.856467, -0.294071, -0.424249 },
  { 0.320781, -0.597803, 0.734664 },
  { 0.298992, -0.497707, 0.814182 },
  { -0.226912, 0.558990, -0.797522 },
  { 0.852706, 0.470488, 0.227012 },
  { 0.282007, -0.742921, -0.607075 },
  { -0.831060, -0.479075, 0.282536 },
  { -0.915511, -0.318781, 0.245393 },
  { -0.166726, 0.968094, 0.187073 },
  { 0.394910, 0.881651, 0.258337 },
  { -0.537006, -0.842152, 0.049035 },
  { 0.160217, 0.574329, -0.802793 },
  { -0.013747, 0.965730, 0.259183 },
  { 0.170938, -0.900841, -0.399081 },
  { 0.012433, -0.582916, -0.812437 },
  { -0.435219, -0.827901, -0.353784 },
  { -0.834144, -0.546597, 0.073733 },
  { -0.686569, 0.376171, -0.622188 },
  { -0.665542, 0.680508, 0.306534 },
  { -0.190771, -0.699867, 0.688326 },
  { -0.339365, 0.872256, -0.352137 },
  { -0.649301, -0.549255, 0.526049 },
  { 0.834546, 0.467027, 0.292263 },
  { -0.325306, -0.164524, -0.931186 },
  { -0.776924, 0.214438, 0.591951 },
  { 0.182232, 0.799088, 0.572931 },
  { -0.086930, -0.958551, -0.271335 },
  { 0.771497, 0.086351, 0.630345 },
  { 0.898546, 0.359454, 0.251808 },
  { 0.053206, 0.066163, 0.996389 },
  { -0.341853, 0.918402, 0.199184 },
  { 0.644064, -0.528104, 0.553432 },
  { 0.488965, 0.567791, -0.662214 },
  { 0.015209, 0.655640, -0.754920 },
  { -0.977677, 0.159851, 0.136366 },
  { 0.924999, 0.141577, -0.352607 },
  { -0.150792, -0.377521, -0.913641 },
  { -0.696289, -0.692405, -0.189093 },
  { 0.623698, -0.268160, -0.734228 },
  { -0.718949, 0.576449, 0.388353 },
  { -0.049788, -0.240043, -0.969485 },
  { -0.493974, -0.009513, 0.869425 },
  { 0.565936, -0.628635, -0.533418 },
  { 0.250307, -0.836014, -0.488290 },
  { -0.641209, -0.614118, 0.460120 },
  { 0.925033, 0.094963, -0.367826 },
  { 0.668047, 0.188168, -0.719934 },
  { -0.619439, 0.541399, -0.568491 },
  { 0.115147, -0.331164, 0.936521 },
  { 0.527487, 0.585177, 0.615894 },
  { 0.148420, -0.504086, 0.850805 },
  { 0.602670, 0.221874, -0.766525 },
  { 0.945357, -0.294107, -0.140716 },
  { 0.814500, -0.517249, 0.262762 },
  { 0.328973, -0.711917, -0.620444 },
  { -0.690634, 0.720444, -0.063128 },
  { -0.297287, -0.038819, -0.953999 },
  { -0.310320, 0.760623, 0.570223 },
  { 0.534635, 0.075123, -0.841738 },
  { -0.686939, 0.585729, -0.430160 },
  { -0.017636, -0.572130, 0.819974 },
  { 0.579549, -0.768519, -0.271112 },
  { -0.964694, -0.094325, 0.245902 },
  { 0.014207, 0.167451, -0.985778 },
  { 0.877315, 0.429703, -0.213714 },
  { 0.829050, -0.273980, 0.487453 },
  { 0.110807, 0.697752, 0.707717 },
  { -0.053726, 0.962009, 0.267680 },
  { 0.129440, -0.532575, 0.836426 },
  { -0.566223, 0.764361, -0.308454 },
  { -0.862232, -0.321205, -0.391642 },
  { -0.059764, -0.453309, 0.889348 },
  { 0.069657, 0.277773, -0.958118 },
  { 0.714772, 0.159324, 0.680968 },
  { 0.592224, 0.747046, -0.301983 },
  { -0.646993, -0.096302, -0.756390 },
  { 0.601812, -0.569610, -0.559792 },
  { -0.181784, 0.959940, 0.213239 },
  { 0.582181, 0.406084, 0.704387 },
  { 0.567595, 0.409864, 0.714036 },
  { 0.701517, -0.019958, -0.712373 },
  { -0.542441, 0.496667, -0.677554 },
  { 0.196452, -0.000976, -0.980513 },
  { -0.586254, 0.797205, 0.144121 },
  { -0.298993, -0.920796, 0.250477 },
  { 0.099973, -0.768451, -0.632050 },
  { 0.539943, -0.048562, 0.840300 },
  { 0.029270, -0.975392, 0.218527 },
  { -0.511911, -0.548958, 0.660751 },
  { 0.651108, -0.512459, -0.559861 },
  { -0.965684, -0.239234, 0.101105 },
  { -0.418637, -0.782291, -0.461263 },
  { -0.830688, -0.434055, -0.348647 },
  { -0.299966, 0.953867, 0.012580 },
  { 0.930133, 0.062358, 0.361890 },
  { -0.499369, -0.332315, -0.800124 },
  { -0.119617, -0.642227, -0.757123 },
  { -0.495267, -0.413771, -0.763874 },
  { -0.019661, 0.338464, 0.940774 },
  { -0.725953, -0.048625, 0.686023 },
  { 0.379238, 0.923731, -0.053847 },
  { 0.669036, 0.741318, -0.053285 },
  { -0.744907, -0.265180, -0.612203 },
  { 0.172831, 0.278813, -0.944665 },
  { 0.754877, -0.548621, -0.359411 },
  { -0.116928, -0.953014, -0.279451 },
  { -0.228846, 0.958048, -0.172548 },
  { -0.988633, -0.127040, -0.080416 },
  { 0.227900, -0.918496, 0.323151 },
  { -0.193327, -0.929429, -0.314304 },
  { -0.286384, 0.008954, 0.958073 },
  { 0.024341, 0.955393, 0.294334 },
  { 0.825471, 0.291533, -0.483329 },
  { 0.757069, 0.585692, -0.289503 },
  { 0.531399, 0.737633, 0.416548 },
  { 0.666281, -0.663866, 0.339633 },
  { 0.464248, 0.812951, 0.351547 },
  { -0.810707, 0.491672, -0.317824 },
  { 0.287846, 0.830616, 0.476678 },
  { 0.535121, 0.367060, -0.760863 },
  { -0.504212, -0.720442, -0.476166 },
  { -0.128253, 0.926919, -0.352665 },
  { -0.230320, 0.807387, -0.543211 },
  { 0.559195, -0.658124, 0.504157 },
  { 0.938597, 0.324421, 0.117416 },
  { 0.824317, -0.425596, -0.373323 },
  { 0.877474, 0.242438, -0.413839 },
  { 0.221363, -0.228738, -0.947986 },
  { -0.159302, -0.983973, -0.080127 },
  { 0.078121, 0.661042, 0.746271 },
  { -0.248497, 0.889876, 0.382582 },
  { -0.086369, 0.487231, 0.868991 },
  { 0.518405, -0.399967, -0.755832 },
  { -0.206964, 0.922521, -0.325762 },
  { 0.307952, 0.838048, -0.450379 },
  { -0.060656, -0.531574, 0.844837 },
  { 0.175886, -0.977080, 0.119911 },
  { -0.385173, -0.887583, -0.252660 },
  { -0.531684, 0.015698, 0.846797 },
  { -0.285358, 0.736801, -0.612940 },
  { -0.968351, -0.240964, 0.065053 },
  { 0.626380, 0.621841, -0.470066 },
  { 0.340224, 0.937712, 0.070308 },
  { 0.534420, 0.698159, 0.476412 },
  { -0.959572, 0.088727, -0.267113 },
  { 0.125971, 0.898589, -0.420321 },
  { -0.688403, 0.123503, -0.714737 },
  { -0.052970, 0.022751, 0.998337 },
  { 0.302625, 0.750579, 0.587409 },
  { 0.202770, -0.976807, -0.068793 },
  { 0.674213, -0.634076, -0.378661 },
  { 0.581988, -0.750167, -0.313909 },
  { 0.901878, -0.419152, 0.104537 },
  { -0.743577, 0.466273, -0.479251 },
  { -0.872452, 0.457392, 0.172106 },
  { -0.031692, 0.400294, 0.915839 },
  { 0.299943, 0.250341, 0.920523 },
  { -0.393728, 0.044224, -0.918162 },
  { -0.681713, -0.731599, 0.005563 },
  { 0.879350, -0.475029, 0.033030 },
  { -0.890753, 0.447572, 0.078982 },
  { 0.164982, -0.841739, -0.514059 },
  { -0.575412, -0.142948, 0.805274 },
  { 0.740574, 0.625394, -0.245829 },
  { 0.543596, 0.799336, 0.256058 },
  { -0.610838, 0.732597, 0.300298 },
  { -0.712480, 0.535687, -0.453223 },
  { -0.533359, -0.844088, -0.055174 },
  { -0.890967, 0.321839, 0.320310 },
  { -0.426292, 0.034647, 0.903922 },
  { -0.437680, -0.700001, 0.564301 },
  { 0.044754, -0.292610, -0.955184 },
  { 0.892716, 0.402354, 0.202904 },
  { -0.224960, 0.320516, -0.920143 },
  { -0.360932, 0.795802, -0.486238 },
  { -0.179874, 0.920927, -0.345744 },
  { 0.085296, -0.167613, 0.982156 },
  { 0.272907, -0.752706, 0.599129 },
  { 0.125881, 0.683827, 0.718703 },
  { -0.228199, 0.793171, 0.564629 },
  { 0.300763, 0.774396, 0.556644 },
  { 0.341662, 0.733157, -0.588003 },
  { 0.840972, 0.419944, 0.341193 },
  { -0.798321, 0.576183, -0.175205 },
  { 0.968331, 0.056189, -0.243267 },
  { -0.468940, -0.033188, -0.882606 },
  { 0.452231, -0.869517, -0.198562 },
  { 0.556398, 0.583092, 0.591968 },
  { -0.006280, 0.993352, 0.114941 },
  { -0.128654, -0.216075, -0.967864 },
  { 0.471897, 0.255662, 0.843771 },
  { -0.133253, -0.163778, -0.977456 },
  { 0.756667, 0.095382, -0.646806 },
  { 0.474414, 0.554509, 0.683704 },
  { 0.510027, 0.811530, -0.285115 },
  { 0.555407, 0.417297, -0.719296 },
  { 0.337629, -0.846724, 0.411176 },
  { 0.452912, 0.378253, -0.807339 },
  { -0.288614, -0.912729, 0.289184 },
  { -0.506109, 0.857552, 0.091965 },
  { -0.516760, 0.680679, 0.519263 },
  { -0.465464, -0.272582, -0.842046 },
  { -0.464403, 0.459228, 0.757258 },
  { 0.676233, 0.720034, -0.155756 },
  { 0.183807, -0.002258, -0.982960 },
  { -0.078603, -0.991221, 0.106317 },
  { -0.049459, -0.366779, -0.928993 },
  { -0.396254, 0.906575, -0.145277 },
  { -0.301486, -0.756678, -0.580125 },
  { 0.767771, -0.419933, -0.483925 },
  { -0.522493, 0.214684, -0.825174 },
  { 0.423851, -0.801937, 0.421008 },
  { -0.896105, 0.382789, 0.224654 },
  { -0.428628, -0.849052, -0.308851 },
  { 0.361776, 0.485403, -0.795929 },
  { 0.522619, -0.807518, -0.273465 },
  { 0.423904, -0.644243, -0.636598 },
  { -0.304525, -0.161806, 0.938660 },
  { 0.126630, 0.991939, 0.004649 },
  { 0.707618, -0.590711, 0.387734 },
  { -0.844274, 0.279176, 0.457451 },
  { -0.912198, 0.221629, 0.344638 },
  { -0.091855, 0.523240, 0.847221 },
  { 0.450933, 0.048344, -0.891248 },
  { -0.792076, 0.426749, -0.436464 },
  { -0.179268, -0.057797, 0.982101 },
  { 0.742464, -0.577559, -0.339370 },
  { 0.958954, -0.044675, 0.280022 },
  { -0.029418, 0.726394, -0.686649 },
  { -0.537435, 0.693647, 0.479602 },
  { 0.810120, 0.585439, 0.031082 },
  { -0.032919, 0.954478, -0.296460 },
  { -0.850786, -0.476171, 0.222315 },
  { 0.770361, 0.179283, -0.611884 },
  { 0.227698, 0.457258, -0.859691 },
  { -0.826775, 0.293863, 0.479675 },
  { 0.742254, 0.589662, 0.318367 },
  { -0.130550, -0.774972, 0.618365 },
  { 0.466138, 0.504720, -0.726618 },
  { -0.683577, 0.418475, -0.597998 },
  { -0.090071, 0.995410, -0.032344 },
  { -0.300498, 0.776900, -0.553287 },
  { -0.853536, 0.520901, 0.011753 },
  { -0.513922, 0.161012, 0.842591 },
  { -0.671221, 0.595833, -0.440960 },
  { -0.802246, -0.506275, 0.316366 },
  { -0.445851, 0.662021, 0.602450 },
  { -0.013322, -0.933378, 0.358647 },
  { 0.827094, -0.544855, -0.138020 },
  { -0.067419, -0.943655, -0.323991 },
  { -0.960494, 0.265624, -0.083042 },
  { 0.318617, -0.444411, 0.837247 },
  { 0.915055, 0.402203, -0.030110 },
  { 0.378920, -0.591949, 0.711348 },
  { 0.822188, -0.498401, 0.274960 },
  { 0.132932, 0.969212, -0.207259 },
  { 0.695387, -0.417978, -0.584578 },
  { -0.505677, -0.091256, -0.857883 },
  { 0.923446, -0.353054, 0.150333 },
  { -0.803466, 0.422502, 0.419446 },
  { 0.805841, -0.427477, 0.409737 },
  { 0.324148, 0.541155, -0.775937 },
  { 0.401203, 0.829424, -0.388705 },
  { -0.877945, -0.363251, -0.311867 },
  { 0.171425, -0.347970, -0.921700 },
  { -0.391921, 0.558337, 0.731203 },
  { -0.468420, -0.100629, -0.877756 },
  { 0.442084, -0.729745, 0.521569 },
  { -0.455432, 0.640599, 0.618235 },
  { -0.936410, 0.298022, -0.185253 },
  { 0.320698, -0.586026, -0.744128 },
  { 0.748037, -0.558703, -0.358179 },
  { 0.946403, -0.226193, -0.230563 },
  { -0.179829, 0.286696, 0.940993 },
  { 0.753934, -0.250559, 0.607292 },
  { 0.359272, 0.121943, -0.925232 },
  { 0.713504, -0.581684, -0.390585 },
  { 0.122556, -0.671894, -0.730437 },
  { -0.436406, 0.263219, -0.860387 },
  { 0.766414, 0.354465, -0.535691 },
  { -0.626042, -0.512241, -0.587945 },
  { -0.982777, 0.079679, 0.166737 },
  { 0.030853, 0.655030, 0.754973 },
  { 0.803440, -0.418569, -0.423419 },
  { 0.414515, 0.571411, 0.708284 },
  { -0.905475, 0.256226, -0.338324 },
  { -0.538767, -0.842453, 0.001886 },
  { 0.632842, 0.462316, -0.621108 },
  { -0.341146, -0.443481, 0.828821 },
  { 0.233712, -0.812747, 0.533686 },
  { 0.845129, 0.406135, 0.347580 },
  { -0.494801, 0.846211, 0.197738 },
  { 0.278951, 0.523168, -0.805284 },
  { -0.903388, 0.428637, -0.012673 },
  { -0.465485, -0.218468, 0.857669 },
  { 0.394704, -0.271574, -0.877756 },
  { 0.965820, 0.065735, -0.250741 },
  { 0.476553, 0.351616, 0.805769 },
  { 0.228378, 0.892878, 0.388088 },
  { -0.764195, 0.240949, 0.598289 },
  { -0.356078, 0.680773, 0.640123 },
  { 0.759792, 0.111945, 0.640457 },
  { -0.263836, 0.702743, 0.660715 },
  { 0.497672, 0.130612, 0.857475 },
  { 0.606523, 0.423702, -0.672761 },
  { -0.401258, 0.767672, -0.499672 },
  { 0.808735, 0.278449, -0.518088 },
  { 0.993759, 0.007585, -0.111288 },
  { -0.696070, 0.664859, 0.271014 },
  { -0.057492, 0.002281, -0.998343 },
  { 0.526446, -0.140085, -0.838589 },
  { 0.744689, 0.621173, -0.244095 },
  { 0.999242, -0.038649, -0.004690 },
  { 0.744389, -0.551196, -0.376919 },
  { 0.271424, 0.355887, 0.894245 },
  { 0.757434, -0.526710, 0.385838 },
  { 0.009812, 0.973661, 0.227790 },
  { 0.668664, -0.605332, 0.431812 },
  { 0.869858, -0.458015, -0.183216 },
  { 0.804435, 0.593879, 0.013872 },
  { -0.259054, 0.581310, -0.771343 },
  { -0.606035, 0.639260, 0.473359 },
  { -0.294011, -0.238086, 0.925674 },
  { 0.009980, -0.131959, 0.991205 },
  { 0.364041, 0.777249, 0.513185 },
  { -0.442847, 0.895830, 0.037087 },
  { -0.530425, -0.200057, 0.823788 },
  { 0.209243, -0.676670, -0.705928 },
  { 0.201485, -0.172707, -0.964145 },
  { -0.274178, 0.571102, -0.773737 },
  { 0.070359, -0.995819, 0.058267 },
  { -0.465441, 0.849582, -0.248145 },
  { -0.492487, -0.736514, 0.463685 },
  { 0.821287, -0.459253, 0.338488 },
  { -0.434450, 0.327376, 0.839094 },
  { 0.063887, 0.656820, 0.751336 },
  { 0.466861, 0.768008, 0.438411 },
  { -0.716232, -0.293789, 0.633009 },
  { -0.304137, -0.755459, 0.580330 },
  { -0.183817, 0.225858, -0.956661 },
  { 0.182940, 0.414600, -0.891426 },
  { 0.491680, -0.558585, -0.668008 },
  { 0.152847, -0.988229, 0.006480 },
  { -0.716642, -0.400527, 0.570965 },
  { -0.575722, -0.165538, -0.800713 },
  { 0.112626, 0.388006, 0.914750 },
  { 0.493738, 0.692193, -0.526395 },
  { 0.041832, -0.598573, -0.799975 },
  { -0.516542, -0.827350, 0.220629 },
  { 0.712301, 0.563826, 0.418004 },
  { -0.076143, 0.826539, 0.557706 },
  { 0.083159, 0.957081, -0.277635 },
  { -0.268689, -0.254582, 0.928975 },
  { -0.793483, 0.104444, 0.599564 },
  { -0.831496, -0.215517, -0.512023 },
  { -0.044505, 0.812190, -0.581694 },
  { 0.623519, -0.765062, -0.160948 },
  { -0.449822, 0.304288, -0.839684 },
  { -0.587569, -0.807968, -0.044164 },
  { -0.247827, 0.817371, -0.520083 },
  { -0.079906, -0.614322, -0.784999 },
  { 0.487544, -0.349049, -0.800291 },
  { 0.779171, 0.073330, -0.622507 },
  { 0.536702, -0.624538, -0.567365 },
  { -0.886550, -0.332149, 0.322034 },
  { 0.154963, -0.957629, 0.242762 },
  { -0.007369, -0.748791, 0.662765 },
  { -0.828735, 0.306462, -0.468273 },
  { -0.763185, -0.637033, 0.108340 },
  { 0.749328, 0.649474, 0.129195 },
  { 0.656446, 0.743042, 0.130260 },
  { -0.265201, 0.301134, -0.915962 },
  { -0.641872, 0.677909, -0.358386 },
  { -0.926182, -0.130783, 0.353669 },
  { -0.171342, -0.877913, -0.447113 },
  { 0.813978, 0.009112, 0.580825 },
  { 0.162814, 0.412822, -0.896141 },
  { -0.018437, 0.644137, -0.764688 },
  { -0.493472, 0.034169, -0.869090 },
  { -0.835751, -0.432764, -0.337988 },
  { -0.217658, -0.848967, -0.481539 },
  { -0.033696, -0.975094, -0.219219 },
  { -0.549450, -0.674479, 0.493136 },
  { 0.985145, 0.136312, -0.104446 },
  { 0.363847, -0.877765, -0.311678 },
  { 0.435801, -0.849307, 0.297919 },
  { -0.043807, -0.978995, 0.199125 },
  { -0.446636, -0.624431, 0.640782 },
  { -0.751254, -0.290981, -0.592409 },
  { 0.049596, -0.642255, -0.764885 },
  { 0.341435, -0.004384, 0.939895 },
  { 0.786088, 0.097736, 0.610338 },
  { 0.904950, -0.190622, -0.380432 },
  { -0.926999, -0.328793, -0.180465 },
  { 0.739980, -0.105977, 0.664227 },
  { -0.967371, -0.253347, -0.002934 },
  { 0.687197, 0.682733, 0.248267 },
  { -0.283092, 0.408530, 0.867734 },
  { -0.813658, -0.389613, 0.431465 },
  { -0.443187, 0.257776, -0.858567 },
  { 0.936459, 0.049601, -0.347254 },
  { 0.467354, 0.373686, -0.801211 },
  { 0.851221, -0.481655, 0.208401 },
  { 0.246943, -0.556325, -0.793424 },
  { -0.701572, -0.293695, 0.649261 },
  { -0.668361, -0.608273, -0.428133 },
  { 0.097724, 0.761900, -0.640280 },
  { -0.922516, -0.146019, 0.357270 },
  { 0.154209, -0.943173, 0.294352 },
  { 0.467751, -0.862372, -0.193711 },
  { 0.810290, 0.085767, 0.579719 },
  { -0.834993, 0.539841, -0.106581 },
  { 0.299655, 0.909385, 0.288490 },
  { -0.139859, 0.031648, 0.989666 },
  { -0.454607, -0.005487, -0.890675 },
  { -0.484711, 0.133141, -0.864482 },
  { -0.815821, -0.495674, -0.297898 },
  { -0.110599, -0.933598, 0.340825 },
  { -0.770067, -0.637939, 0.005446 },
  { -0.203931, -0.700452, 0.683943 },
  { -0.043166, 0.497859, -0.866183 },
  { -0.072044, 0.936654, 0.342766 },
  { 0.205938, -0.952559, 0.224100 },
  { 0.475431, -0.727661, 0.494444 },
  { -0.263243, 0.675210, 0.689053 },
  { 0.611864, -0.347292, -0.710641 },
  { 0.763953, 0.498043, 0.410280 },
  { -0.968285, -0.106058, 0.226220 },
  { 0.179075, -0.499386, -0.847671 },
  { -0.732586, -0.290586, 0.615530 },
  { 0.063055, -0.927359, -0.368820 },
  { -0.249228, 0.616524, 0.746849 },
  { -0.155237, 0.496415, -0.854092 },
  { 0.174127, 0.091182, 0.980493 },
  { 0.416500, 0.300648, 0.857985 },
  { 0.961373, 0.183000, 0.205604 },
  { -0.134468, -0.023728, -0.990634 },
  { -0.817159, -0.522716, -0.242938 },
  { 0.425053, -0.111492, 0.898276 },
  { -0.047873, 0.850057, 0.524511 },
  { 0.433734, 0.238074, -0.869020 },
  { 0.570206, 0.113191, 0.813666 },
  { -0.379549, 0.534016, -0.755493 },
  { -0.850820, 0.374208, 0.368882 },
  { -0.406226, 0.343068, -0.846927 },
  { 0.621089, 0.300755, 0.723737 },
  { 0.627779, -0.046224, 0.777018 },
  { -0.397920, 0.158453, -0.903633 },
  { 0.715629, 0.696179, 0.056663 },
  { -0.651036, -0.696037, 0.302796 },
  { 0.516249, 0.727538, 0.451858 },
  { 0.642526, 0.352402, -0.680422 },
  { -0.072486, -0.072784, -0.994710 },
  { -0.360409, 0.890351, 0.278174 },
  { 0.167909, 0.760318, -0.627474 },
  { 0.470540, -0.463398, 0.750902 },
  { 0.921946, -0.387159, -0.011134 },
  { -0.590517, -0.447437, -0.671632 },
  { 0.022340, 0.410595, 0.911544 },
  { 0.865762, 0.010567, 0.500345 },
  { -0.486508, 0.462120, 0.741455 },
  { -0.640965, 0.019029, 0.767334 },
  { 0.876065, 0.110841, 0.469281 },
  { -0.599658, -0.310801, -0.737437 },
  { 0.362056, -0.603449, -0.710469 },
  { 0.026925, -0.578459, -0.815267 },
  { 0.577654, 0.756625, -0.306324 },
  { -0.262318, 0.684722, -0.679960 },
  { 0.357899, -0.205025, -0.910973 },
  { -0.590855, 0.789792, -0.164679 },
  { 0.016585, 0.786193, 0.617758 },
  { -0.844811, -0.513866, 0.149114 },
  { 0.104819, 0.948089, 0.300234 },
  { -0.617456, 0.081255, 0.782398 },
  { 0.303620, -0.952711, 0.012485 },
  { -0.906679, 0.329027, -0.263958 },
  { -0.133919, 0.261711, 0.955810 },
  { -0.671229, 0.556235, -0.489953 },
  { 0.032173, -0.830021, -0.556803 },
  { 0.496495, -0.737989, -0.457018 },
  { 0.883304, -0.113589, 0.454831 },
  { 0.269907, -0.910493, 0.313292 },
  { 0.486598, -0.533338, 0.691934 },
  { -0.340130, -0.692021, -0.636725 },
  { 0.191323, -0.959369, 0.207379 },
  { 0.667569, -0.608875, 0.428512 },
  { -0.865592, -0.463945, 0.188429 },
  { -0.048376, 0.380319, 0.923589 },
  { 0.889875, -0.401163, -0.217233 },
  { 0.694498, -0.414669, -0.587982 },
  { 0.420881, -0.841951, -0.337606 },
  { -0.687794, -0.466447, 0.556207 },
  { -0.924930, -0.020465, 0.379585 },
  { -0.638447, -0.727984, 0.249850 },
  { 0.097806, -0.854334, -0.510439 },
  { -0.054279, -0.976997, -0.206229 },
  { 0.118459, -0.946092, -0.301458 },
  { 0.019812, -0.942242, 0.334346 },
  { 0.292305, 0.886997, -0.357482 },
  { 0.199505, 0.090973, -0.975665 },
  { 0.432515, -0.866583, -0.248928 },
  { 0.205473, 0.914886, 0.347512 },
  { -0.931087, 0.363994, 0.024181 },
  { 0.008048, 0.958280, 0.285717 },
  { -0.605392, -0.755632, 0.250043 },
  { 0.655636, -0.512395, -0.554611 },
  { -0.590485, 0.555916, 0.585051 },
  { 0.395992, -0.016862, -0.918099 },
  { 0.654092, 0.155384, -0.740284 },
  { 0.764406, 0.320086, -0.559668 },
  { -0.945692, -0.176244, -0.273137 },
  { 0.610379, -0.156409, 0.776514 },
  { 0.901669, 0.350296, 0.253547 },
  { -0.490413, -0.845830, 0.209921 },
  { -0.427959, -0.896042, 0.118154 },
  { 0.321430, -0.203904, 0.924719 },
  { -0.708019, 0.323729, 0.627621 },
  { -0.323563, 0.141653, 0.935543 },
  { -0.719132, 0.672043, -0.176656 },
  { 0.150506, 0.984818, 0.086490 },
  { -0.757823, 0.547158, 0.355417 },
  { 0.909527, -0.198794, 0.365023 },
  { -0.999171, 0.008852, 0.039724 },
};

void setup() {
  Serial.begin(115200);

  while(CAN.begin(CANController::Mode::Normal) != CANController::OK) {
    Serial.println("CAN begin FAIL - delaying for 1 second");
    delay(1000);
  }
  Serial.println("CAN begin OK");

  resetMotor(0x141);
  resetMotor(0x142);

  pinMode(7, OUTPUT);
  randomSeed(SEED);

  // cant use this cuz gets stored in SRAM not PROGMEM
  // if (currentProfile == MOTOR_BRW) {
  //   for (int i = 0; i < NUM_POINTS; i++){
  //     generateUniformSpherePoint(veloBRW_pts[i]);
  //   }
  //   Serial.println("uniform point generation complete");

  //   for (int i = 0; i < NUM_POINTS; i++) {
  //     Serial.print("Point ");
  //     Serial.print(i);
  //     Serial.print(": ");
  //     Serial.print(veloBRW_pts[i][0], 4);  // 4 decimal places
  //     Serial.print(", ");
  //     Serial.print(veloBRW_pts[i][1], 4);
  //     Serial.print(", ");
  //     Serial.println(veloBRW_pts[i][2], 4);
  //   }
  // }
}

void loop() {
  long time = millis();
  int cyclePosition = time%TIMING_CYCLE;

  if(cyclePosition > SERIAL_TIMING && cyclePosition <= SERIAL_TIMING + TIMING_TOLERANCE){
    if(Serial.available() > 0){
      char inChar = Serial.read();
      switch (inChar) {
        case '0':
          setMotorProfile(MOTOR_BOTH_OFF);
          break;
        case '1':
          setMotorProfile(MOTOR_SIMPLIFIED_RANDOM);
          break;
        case '2':
          setMotorProfile(MOTOR_2D);
          break;
        case '3':
          setMotorProfile(MOTOR_3D);
          break;
        case '4':
          setMotorProfile(MOTOR_IRRATIONAL);
          break;
        case '5':
          setMotorProfile(MOTOR_CYCLOIDAL);
          break;
        case '6':
          setMotorProfile(MOTOR_BRW);
          break;
        default :
          setMotorProfile(currentProfile);
          break;
      }
      // Serial.println("--");
      // Serial.println(inChar);
      // Serial.println((int)inChar);
      // Serial.println("--");
      if(inChar >= 48 && inChar <= 57){
        // inst += inChar;
      }else if(inChar == 'p'){
        mode = 'p';
        resetMotor(0x141);
        resetMotor(0x142);
        // setCurrent(0x141,0);
        // setCurrent(0x142,0);
      }else if(inChar == 'a'){
        mode = 'a';
        resetMotor(0x141);
        resetMotor(0x142);
        // setCurrent(0x141,0);
        // setCurrent(0x142,0);
      }else if(inChar == 'v'){
        mode = 'v';
        resetMotor(0x141);
        resetMotor(0x142);
        // setCurrent(0x141,0);
        // setCurrent(0x142,0);
      }else if(inChar == 'r'){
        mode = ' ';
        resetMotor(0x141);
        resetMotor(0x142);
        // setCurrent(0x141,0);
        // setCurrent(0x142,0);
      }else if(mode == 'p' && inChar == endCharA){
        // valueA = atof(inst.c_str());
        // setAngleSingle(0x141,MAX_VELO_RPM,(int16_t)(valueA*100));
        // inst = "";
      }else if(mode == 'p' && inChar == endCharB){
        // valueB = atof(inst.c_str());
        // setAngleSingle(0x142,MAX_VELO_RPM,(int16_t)(valueB*100));
        // inst = "";
      }else if(mode == 'v' && inChar == endCharA){
        // valueA = atof(inst.c_str());
        // setVelocity(0x141,(int32_t)(valueA*100));
        // inst = "";
      }else if(mode == 'v' && inChar == endCharB){
        // valueB = atof(inst.c_str());
        // setVelocity(0x142,(int32_t)(valueB*100));
        // inst = "";
      }else if(inChar == purge){
        // inst = "";
      }else if(inChar == 'd'){
        Serial.print("#");
        Serial.print(motors[0].encoder);
        Serial.print("=");
        Serial.print(motors[1].encoder);
        Serial.print("=");
      }
    }
  }else if(cyclePosition > COMMAND_TIMING && cyclePosition <= COMMAND_TIMING + TIMING_TOLERANCE){
    if(!commandSent){
      if(mode == 'a'){
        if (currentProfile == MOTOR_CYCLOIDAL) {
          long elapsed_time_ms = millis();
          long curr_cycle_time = elapsed_time_ms % CYCLOIDAL_TIME_PER_ROTATION;
          velo_angle = 2 * PI * (float)(curr_cycle_time) / CYCLOIDAL_TIME_PER_ROTATION + PI;
          double velo_angle_rad = velo_angle * 3.14159 / 180;
          // Serial.print((int32_t)(sin(velo_angle_rad) * MAX_VELO_RPM * 6 * 100));
          // Serial.print("=");
          Serial.println((int32_t)(cos(velo_angle_rad) * MAX_VELO_RPM * 6 * 100));
          setVelocity(0x141,(int32_t)(sin(velo_angle_rad) * MAX_VELO_RPM * 6 * 100));
          setVelocity(0x142,(int32_t)(cos(velo_angle_rad) * MAX_VELO_RPM * 6 * 100));
        }









        else if(currentProfile == MOTOR_BRW) {
          long current_time = millis();
          long elapsed_time = current_time-previous_time;
          
          float inner_rad = motors[1].encoder * (TWO_PI / ENCODER_MAX_TICKS);
          float outer_rad = motors[0].encoder * (TWO_PI / ENCODER_MAX_TICKS);
          // always update current spherical position from motor encoders
          pos_sph[0] = inner_rad; // should be 0x142 (inner)
          pos_sph[1] = outer_rad; // should be 0x141 (outer)
          if(elapsed_time > veloBRW_changeDT) { // every 200 milliseconds
            previous_time = current_time;

            // store prev_pos
            sph2cart(veloBRW_prevPos[0], veloBRW_prevPos[1], &prev_x, &prev_y, &prev_z);
            // store curr_pos
            sph2cart(pos_sph[0],pos_sph[1], &curr_x, &curr_y, &curr_z); 
            // Serial.print(curr_x);
            // Serial.print("=");
            // Serial.print(curr_y);
            // Serial.print("=");
            // Serial.println(curr_z);

            // get velo
            float velo_x = 0, velo_z = 0, velo_y = 0; 
            v3Sub(curr_x, curr_y, curr_z, 
                  prev_x, prev_y, prev_z,
                  &velo_x, &velo_y, &velo_z);
            v3Scale(&velo_x, &velo_y, &velo_z, 1/(veloBRW_changeDT/1000));
            
            // fill candidatePts array (could also just store indices and memcpy from PROGMEM if too big)
            float candidatePt[3] = {0}; // An array of 3 floats
            float cand_x = 0, cand_y = 0, cand_z = 0; 
            int j = 0;
            for (int i = 0; i < NUM_POINTS; i++) {
              // copy from PROGMEM into SRAM
              memcpy_P(&candidatePt, &veloBRW_pts[i], sizeof(candidatePt));
              v3Sub(candidatePt[0], candidatePt[1], candidatePt[2], curr_x, curr_y, curr_z, &cand_x, &cand_y, &cand_z);
              float magS = magSquared3(cand_x, cand_y, cand_z);
              if(magS < veloBRW_coneLengthSquared && magS > veloBRW_coneMinLengthSquared){
                if(magSquared3(velo_x, velo_y, velo_z) == 0 || v3Angle(cand_x, cand_y, cand_z, velo_x, velo_y, velo_z) < veloBRW_coneAngle) {

                  // // --- ADD THIS BLOCK ---
                  //   Serial.print("  [Candidate "); Serial.print(i); Serial.print("] Passed!");
                  //   Serial.print(" MagS: "); Serial.print(magS);
                  //   Serial.print(" Angle: "); Serial.println(v3Angle(cand_x, cand_y, cand_z, velo_x, velo_y, velo_z));
                  //   // --- END BLOCK ---

                  veloBRW_pointsInRange[j][0] = candidatePt[0];
                  veloBRW_pointsInRange[j][1] = candidatePt[1];
                  veloBRW_pointsInRange[j][2] = candidatePt[2];
                  j++;
                  if (j >= CAND_POINTS) {
                    Serial.println("too many candidate points");
                    break;
                  }
                }
              }
            }

            float chosenPt[3] = {0}; // An array of 3 floats
            if (j != 0) {
              // Get a random number between 0 and number of vectors that have been stored
              long randomIndex = random(j);
              // store chosen point from random index
              des_x = veloBRW_pointsInRange[randomIndex][0];
              des_y = veloBRW_pointsInRange[randomIndex][1];
              des_z = veloBRW_pointsInRange[randomIndex][2];
              
              // // --- ADD THIS BLOCK ---
              //   Serial.print("Found "); Serial.print(j); Serial.println(" candidates.");
              //   Serial.print("Chose index: "); Serial.println(randomIndex);
              //   Serial.print("Chosen Pt: ");
              //   Serial.print(des_x); Serial.print(", ");
              //   Serial.print(des_y); Serial.print(", ");
              //   Serial.println(des_z);
                // --- END BLOCK ---

              float k1 = curr_x;
              float k2 = curr_y;
              float k3 = curr_z;

              // float k1_dot = (des_x - k1) / (veloBRW_changeDT/1000);
              // float k2_dot = (des_y - k2) / (veloBRW_changeDT/1000);
              // float k3_dot = (des_z - k3) / (veloBRW_changeDT/1000);
              float Kp = 50.0;

              float k1_dot = (des_x - k1) * Kp;
              float k2_dot = (des_y - k2) * Kp;
              float k3_dot = (des_z - k3) * Kp;

              double epsilon = 1e-6; 

              // q1_dot = ((k1*k2_dot) - (k2*k1_dot)) / (k1*k1 + k2*k2 + epsilon); // outer
              // q2_dot = -k3_dot / (sqrt(k1*k1 + k2*k2) + epsilon); // inner

              double denominator_sq = k1*k1 + k2*k2;
              double denominator_sqrt = sqrt(denominator_sq);

              // Logic near singularity, otherwise normal kinematics
              if (denominator_sqrt < 1e-5) { 
                  q1_dot = 0; // Rotation around z-axis is undefined, so set to 0
                  q2_dot = -k3_dot / (denominator_sqrt + epsilon); // This might still be large, but it's the only valid motion
              } else {
                  q1_dot = ((k1*k2_dot) - (k2*k1_dot)) / (denominator_sq + epsilon);
                  q2_dot = -k3_dot / (denominator_sqrt + epsilon);
              }

              norm2(q1_dot, q2_dot, &q1_dot_norm, &q2_dot_norm);
              v2Scale(&q1_dot_norm, &q2_dot_norm, MAX_VELO_RPM);
              Serial.print(q1_dot_norm);
              Serial.print("=");
              Serial.println(q2_dot_norm);
            } else {
              Serial.println("NO POINTS FOUND");
            }
            // store curr into prev
            veloBRW_prevPos[0] = pos_sph[0];
            veloBRW_prevPos[1] = pos_sph[1];
          }
          setVelocity(0x141, q1_dot_norm * 6 * 100);
          setVelocity(0x142, q2_dot_norm * 6 * 100);  
        }






        else if(commandLoop > DT_CYCLES){
          // off by default
          if (currentProfile == MOTOR_BOTH_OFF) {
            setVelocity(0x141,0);
            setVelocity(0x142,0);
          }
          else if (currentProfile == MOTOR_SIMPLIFIED_RANDOM) {
            heading += (random(65536)/65536.0) * ANGLE_OF_ATTACK - (ANGLE_OF_ATTACK/2);
            double heading_rad = heading * 3.14159 / 180;
            setVelocity(0x141,(int32_t)(sin(heading_rad)*MAX_VELO_RPM * 6 * 100));
            setVelocity(0x142,(int32_t)(cos(heading_rad)*MAX_VELO_RPM * 6 * 100));
          }

          else if (currentProfile == MOTOR_2D) {
            setVelocity(0x141,MAX_VELO_RPM * 6 * 100);
            setVelocity(0x142,0);  
          }

          else if (currentProfile == MOTOR_3D) {
            // Serial.print(MAX_VELO_RPM * 6 * 100);
            // Serial.print("=");
            // Serial.print(MAX_VELO_RPM * 6 * 100);
            setVelocity(0x141,MAX_VELO_RPM * 6 * 100);
            setVelocity(0x142,MAX_VELO_RPM * 6 * 100);  
          }

          else if (currentProfile == MOTOR_IRRATIONAL) {
            double heading_rad = atan2(3.14159265358979,exp(1));
            setVelocity(0x141,(int32_t)(sin(heading_rad)*MAX_VELO_RPM * 6 * 100));
            setVelocity(0x142,(int32_t)(cos(heading_rad)*MAX_VELO_RPM * 6 * 100));
          }
          // printMotor(motorA,'a');
          // printMotor(motorB,'b');
          commandLoop = 0;
          pointCount ++;
          digitalWrite(7, HIGH);
        }else{
          queryMotor(0x141);
          queryMotor(0x142);
          digitalWrite(7, LOW);
        }
        commandLoop ++;
      }else{
        queryMotor(0x141);
        queryMotor(0x142);
      }
      commandSent = 1;
    }
  }else if(cyclePosition > QUERY_TIMING && cyclePosition <= QUERY_TIMING + TIMING_TOLERANCE){
    if(!querySent){
      queryMotorEncoder(0x141);
      queryMotorEncoder(0x142);
      querySent = 1;
    }
  }else if(cyclePosition > PRINT_TIMING && cyclePosition <= PRINT_TIMING + TIMING_TOLERANCE){
    if(!printSent){
      if(printLoopCount > 1){

        double heading_rad = heading * 3.14159 / 180;
        // Serial.print("Heading:");
        // Serial.print(heading_rad);
        // Serial.print(" A Des:[");
        // Serial.print(sin(heading_rad)*MAX_VELO_RPM);
        // Serial.print("] Act:[");
        // Serial.print(motors[0].velocity/10.0);
        // Serial.print("] B Des:");
        // Serial.print(cos(heading_rad)*MAX_VELO_RPM);
        // Serial.print("] Act:[");
        // Serial.print(motors[1].velocity/10.0);

        // Serial.print("[Immediate] [");
        // Serial.print(accel.acceleration.x + xOffset);
        // Serial.print("] [");
        // Serial.print(accel.acceleration.y + yOffset);
        // Serial.print("] [");
        // Serial.print(accel.acceleration.z + zOffset);

        // Serial.print("] [Integral G] X:");
        // Serial.print(accelX);
        // Serial.print(" Y:");
        // Serial.print(accelY);
        // Serial.print(" Z:");
        // Serial.print(accelZ);

        // Serial.print(" | PC:");
        // Serial.println(pointCount);

        printLoopCount = 0;
      }
      printLoopCount ++;
      printSent = 1;
    }
  }else{
    serialRead = 0;
    commandSent = 0;
    querySent = 0;
    printSent = 0;
  }

  getFeedback();
}


void printMotor(Motor m, char c = '?'){
  Serial.print("Motor ");
  Serial.print(c);
  Serial.print("| Angle: ");
  Serial.print(m.angle);
  Serial.print("| Velocity");
  Serial.print(m.velocity);
  Serial.print("| Temp");
  Serial.println(m.temp);
}

void setVelocity(uint16_t canID, int32_t velocity_dps_hundreth){
    uint8_t data[8] = { 
        0xA2, 
        0x00, 
        0x00, 
        0x00, 
        (uint8_t)(velocity_dps_hundreth), 
        (uint8_t)(velocity_dps_hundreth>>8), 
        (uint8_t)(velocity_dps_hundreth>>16), 
        (uint8_t)(velocity_dps_hundreth>>24)};

    // uint8_t data[8] = {0xA2, 0x00, 0x00, 0x00, 0x10, 0x27, 0x00, 0x00};
    CANFrame frame(canID, data, sizeof(data));
    // frame.print("TX");
    CAN.write(frame);
}

void setAngleSingle(uint16_t canID, int16_t velocity_dps, int16_t angle_deg_hundreth){
    uint8_t data[8] = { 
        0xA6, 
        0x00, 
        (uint8_t)(velocity_dps), 
        (uint8_t)(velocity_dps>>8), 
        (uint8_t)(angle_deg_hundreth), 
        (uint8_t)(angle_deg_hundreth>>8), 
        0x00, 
        0x00};

    // uint8_t data[8] = {0xA2, 0x00, 0x00, 0x00, 0x10, 0x27, 0x00, 0x00};
    CANFrame frame(canID, data, sizeof(data));
    // frame.print("TX");
    CAN.write(frame);
}

void setCurrent(uint16_t canID, int16_t current_hundreth){
    uint8_t data[8] = { 
        0xA1, 
        0x00, 
        0x00, 
        0x00, 
        (uint8_t)(current_hundreth), 
        (uint8_t)(current_hundreth>>8), 
        0x00, 
        0x00};

    // uint8_t data[8] = {0xA2, 0x00, 0x00, 0x00, 0x10, 0x27, 0x00, 0x00};
    CANFrame frame(canID, data, sizeof(data));
    // frame.print("TX");
    CAN.write(frame);
}

void queryMotor(uint16_t canID){
  sendCommand(canID, 0x9C);
}

void queryMotorEncoder(uint16_t canID){
  sendCommand(canID, 0x90);
}

void resetMotor(uint16_t canID){
  sendCommand(canID, 0x76);
}

void sendCommand(uint16_t canID, uint8_t command){
  uint8_t data[8] = { 
      command, 
      0x00, 
      0x00, 
      0x00, 
      0x00, 
      0x00, 
      0x00, 
      0x00};
  CANFrame frame(canID, data, sizeof(data));
  // frame.print("TX");
  CAN.write(frame);
}

void getFeedback(){
  uint8_t data[8] = {0,0,0,0,0,0,0,0};
  CANFrame frame(0x140,data,8);
  while (CAN.read(frame) == CANController::IOResult::OK) {
      frame.getData(data, 8);
      uint16_t id = frame.getId()-0x241;
      if(id == 0 || id == 1){
        if(data[0] == 0xA1 || data[0] == 0xA2 || data[0] == 0xA6 || data[0] == 0x9C){
            motors[id].angle = (int16_t)(data[6] | (data[7]<<8)); 
            motors[id].velocity = (int16_t)(data[4] | (data[5]<<8));
            motors[id].current = (int16_t)(data[2] | (data[3]<<8));
            motors[id].temp = data[1];
            // if(data[0] == 0x9C){
            //   Serial.println("9C");
            // }
        }else if(data[0] == 0x90){
            motors[id].encoder = (int16_t)(data[2] | (data[3]<<8)); 
            motors[id].encoderRaw = (int16_t)(data[4] | (data[5]<<8));
            motors[id].encoderOffset = (int16_t)(data[6] | (data[7]<<8));
            // frame.print("90");
        }else{
            // frame.print("WUT");
        }
      }
      digitalWrite(7,HIGH);
  }
}

void setMotorProfile(MotorProfile profile) {
  currentProfile = profile;
}













// theta=azimuth phi=elevation
// azimuth=inner elevation=outer
void sph2cart(float theta, float phi, float* x, float* y, float* z) {
  // This is the direct translation of your Python code:
  *x = cos(-phi) * cos(theta);
  *y = cos(-phi) * sin(theta);
  *z = sin(-phi);
}

// scales a 3D vector in place
void v3Scale(float* x, float* y, float* z, float scalar){
  *x *= scalar;
  *y *= scalar;
  *z *= scalar;
}

// subtracts two 3D vectors and stores it in the out variables (does first vector - second vector)
void v3Sub(float x1, float y1, float z1, float x2, float y2, float z2, float* x_out, float* y_out, float* z_out){
  *x_out = x1 - x2;
  *y_out = y1 - y2;
  *z_out = z1 - z2;
}

// returns the square of the magnitude of a 3D vector
float magSquared3(float x, float y, float z) {
  return (x * x) + (y * y) + (z * z);
}

// returns the magnitude (length) of a 3D vector.
float mag3(float x, float y, float z) {
  return sqrt(magSquared3(x, y, z));
}

// Normalizes a 3D vector, storing in output pointers
void norm3(float x_in, float y_in, float z_in, float* x_out, float* y_out, float* z_out) 
{
  float magn = mag3(x_in, y_in, z_in);

  // CRITICAL: Prevent division by zero
  if (magn == 0.0) {
    *x_out = 0.0;
    *y_out = 0.0;
    *z_out = 0.0;
  } else {
    *x_out = x_in / magn;
    *y_out = y_in / magn;
    *z_out = z_in / magn;
  }
}

// finds the angle between two vectors in radians
float v3Angle(float ax, float ay, float az, float bx, float by, float bz) {

  // Variables to hold the normalized vectors
  float norm_ax, norm_ay, norm_az;
  float norm_bx, norm_by, norm_bz;

  // Normalize vector a
  norm3(ax, ay, az, &norm_ax, &norm_ay, &norm_az);

  // Normalize vector b
  norm3(bx, by, bz, &norm_bx, &norm_by, &norm_bz);

  // Calculate the dot product
  float dotP = norm_ax * norm_bx + norm_ay * norm_by + norm_az * norm_bz;

  // Clamp the value to the valid range [-1.0, 1.0]
  // This prevents acos() from returning NaN due to floating-point imprecision
  if (dotP > 1.0) {
    Serial.println("WARNING DOT PRODUCT OUTSIDE OF BOUNDS");
    dotP = 1.0;
  } else if (dotP < -1.0) {
    Serial.println("WARNING DOT PRODUCT OUTSIDE OF BOUNDS");
    dotP = -1.0;
  }

  // Return the angle in radians
  return acos(dotP);
}

// returns the square of the magnitude of a 2D vector
float magSquared2(float x, float y) {
  return (x * x) + (y * y);
}

// returns the magnitude (length) of a 2D vector.
float mag2(float x, float y) {
  return sqrt(magSquared2(x, y));
}

// Normalizes a 2D vector, storing in output pointers
void norm2(float x_in, float y_in, float* x_out, float* y_out) 
{
  float magn = mag2(x_in, y_in);

  // CRITICAL: Prevent division by zero
  if (magn == 0.0) {
    *x_out = 0.0;
    *y_out = 0.0;
  } else {
    *x_out = x_in / magn;
    *y_out = y_in / magn;
  }
}

// scales a 2D vector in place
void v2Scale(float* x, float* y, float scalar){
  *x *= scalar;
  *y *= scalar;
}


// generates a random sphere point
void generateUniformSpherePoint(float result[3]) {
    float x, y, z, mag;

    while (true) {
        // random() gives integer, so scale to [-1, 1]
        x = ((float)random(0, 10001) / 5000.0f) - 1.0f;
        y = ((float)random(0, 10001) / 5000.0f) - 1.0f;
        z = ((float)random(0, 10001) / 5000.0f) - 1.0f;

        mag = sqrt(x * x + y * y + z * z);

        // must be inside unit sphere before normalizing
        if (mag > 0 && mag < 1.0f) {
            norm3(x, y, z, &result[0], &result[1], &result[2]);
            return;
        }
    }
}